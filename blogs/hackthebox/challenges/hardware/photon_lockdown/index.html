<!doctype html><html lang=en><head><title>Photon Lockdown Walkthrough - HackTheBox :: Favas M</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="In this article, I’ll walk you through solving the **Photon Lockdown** hardware challenge from the platform [HackTheBox](https://hackthebox.eu)."><meta name=keywords content="hackthebox,firmware,hardcoded,credentials,mount,filesystem"><meta name=robots content="noodp"><link rel=canonical href=https://favas.dev/blogs/hackthebox/challenges/hardware/photon_lockdown/><link rel=stylesheet href=https://favas.dev/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css><link rel=stylesheet href=https://favas.dev/css/code.min.00125962708925857e7b66dbc58391d55be1191a3d0ce2034de8c9cd2c481c36.css><link rel=stylesheet href=https://favas.dev/css/fonts.min.90c955c31dd7c0e05aae3d4f583d4d8a2af799d69c961337eaf2a825063a55dd.css><link rel=stylesheet href=https://favas.dev/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css><link rel=stylesheet href=https://favas.dev/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://favas.dev/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css><link rel=stylesheet href=https://favas.dev/css/main.min.1d8be2dd1b5de9fdaed058c8c59fcf4485f36619574abfb47ed0cfda4812c16d.css><link rel=stylesheet href=https://favas.dev/css/menu.min.83637a90d903026bc280d3f82f96ceb06c5fc72b7c1a8d686afb5bbf818a29f7.css><link rel=stylesheet href=https://favas.dev/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css><link rel=stylesheet href=https://favas.dev/css/post.min.fc74ca360273c1d828da3c02b8174eba435607b369d98418ccc6f2243cd4e75d.css><link rel=stylesheet href=https://favas.dev/css/prism.min.9023bbc24533d09e97a51a0a42a5a7bfe4c591ae167c5551fb1d2191d11977c0.css><link rel=stylesheet href=https://favas.dev/css/syntax.min.cc789ed9377260d7949ea4c18781fc58959a89287210fe4edbff44ebfc1511b6.css><link rel=stylesheet href=https://favas.dev/css/terminal.min.736caf886baa67df630c4cde30fbdc5115122eb74c6246f15a31401344bfa2f0.css><link rel=stylesheet href=https://favas.dev/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://favas.dev/terminal.css><link rel="shortcut icon" href=https://favas.dev/favicon.png><link rel=apple-touch-icon href=https://favas.dev/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content="clevrf0x"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Photon Lockdown Walkthrough - HackTheBox"><meta property="og:description" content="In this article, I’ll walk you through solving the **Photon Lockdown** hardware challenge from the platform [HackTheBox](https://hackthebox.eu)."><meta property="og:url" content="https://favas.dev/blogs/hackthebox/challenges/hardware/photon_lockdown/"><meta property="og:site_name" content="Favas M"><meta property="og:image" content="https://favas.dev/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Hacking"><meta property="article:section" content="Hardware"><meta property="article:section" content="HackTheBox"><meta property="article:section" content="CTF"><meta property="article:published_time" content="2024-10-06 09:25:54 +0530 +0530"></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>clevrf0x</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About</a></li><li><a href=/blogs>Blogs</a></li><li><a href=/contact>Contact</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About</a></li><li><a href=/blogs>Blogs</a></li><li><a href=/contact>Contact</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://favas.dev/blogs/hackthebox/challenges/hardware/photon_lockdown/>Photon Lockdown Walkthrough - HackTheBox</a></h1><div class=post-meta><time class=post-date>2024-10-06</time><span class=post-author>Favas M</span></div><span class=post-tags>#<a href=https://favas.dev/tags/hacking/>hacking</a>&nbsp;
#<a href=https://favas.dev/tags/hardware/>hardware</a>&nbsp;
#<a href=https://favas.dev/tags/hackthebox/>hackthebox</a>&nbsp;
#<a href=https://favas.dev/tags/ctf/>ctf</a>&nbsp;
#<a href=https://favas.dev/tags/walkthrough/>walkthrough</a>&nbsp;</span><div class=post-content><div><p>In this article, I’ll walk you through solving the <strong>Photon Lockdown</strong> hardware challenge from the platform <a href=https://hackthebox.eu>HackTheBox</a>.</p><p>Challenge description is the following block of text:</p><blockquote><p>We&rsquo;ve located the adversary&rsquo;s location and must now secure access to their Optical Network Terminal to disable their internet connection. Fortunately, we&rsquo;ve obtained a copy of the device&rsquo;s firmware, which is suspected to contain hardcoded credentials. Can you extract the password from it?</p></blockquote><p>The objective seems to be find some hard-coded credentials hidden in these files. I downloaded the challenge files, which seem to be firmware files according to the description.</p><p>The challenge file contains a single zip named &lsquo;Photon Lockdown.zip&rsquo;. When I extracted it using <code>unzip 'Photon Lockdown.zip'</code>, it revealed a directory named <strong>ONT</strong> with three files in it:</p><ul><li><em>fwu_ver</em></li><li><em>hw_ver</em></li><li><em>rootfs</em></li></ul><p>First, I checked what these files contained. The <em>fwu_ver</em> file had raw text data: <strong>3.0.5</strong>. Based on the file name and the content, it&rsquo;s safe to assume this might be the firmware version.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ file fwu_ver
</span></span><span style=display:flex><span>  fwu_ver: ASCII text
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat fwu_ver
</span></span><span style=display:flex><span>  3.0.5
</span></span></code></pre></div><p>The second file, <em>hw_ver</em>, seemed to contain some kind of archived data. So, I thought, why not try to extract it? But I couldn’t. That’s when I decided to check the file size, and to my surprise, it was only 3 bytes. This means it likely isn’t an archive, or there’s nothing useful inside. Still, I ran the <code>cat</code> command on the file just to be sure, and it returned a simple string: &ldquo;X1&rdquo; and nothing else. We can safely assume this represents some kind of hardware version.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ file hw_ver
</span></span><span style=display:flex><span>  hw_ver: X1 archive data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ ls -la
</span></span><span style=display:flex><span>  .rw-r--r--   <span style=color:#ae81ff>6</span> clevrf0x <span style=color:#ae81ff>11</span> Oct  <span style=color:#ae81ff>2023</span> fwu_ver
</span></span><span style=display:flex><span>  .rw-r--r--   <span style=color:#ae81ff>3</span> clevrf0x <span style=color:#ae81ff>11</span> Oct  <span style=color:#ae81ff>2023</span> hw_ver
</span></span><span style=display:flex><span>  .rw-r--r-- 11M clevrf0x  <span style=color:#ae81ff>1</span> Oct  <span style=color:#ae81ff>2023</span> rootfs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat hw_ver
</span></span><span style=display:flex><span>  X1
</span></span></code></pre></div><p>The final file is called <em>rootfs</em>, and from the name, we can guess it’s the firmware’s root file system. To confirm, I ran the <code>file</code> command, which backed up my suspicion.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ file rootfs
</span></span><span style=display:flex><span>  rootfs: Squashfs filesystem, little endian, version 4.0, zlib compressed, <span style=color:#ae81ff>10936182</span> bytes, <span style=color:#ae81ff>910</span> inodes, blocksize: <span style=color:#ae81ff>1310</span>
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>72</span> bytes, created: Sun Oct  <span style=color:#ae81ff>1</span> 07:02:43 <span style=color:#ae81ff>2023</span>
</span></span></code></pre></div><p>The next step is to mount the file system and explore its contents. Let’s create a temporary directory to mount the file system, and then proceed with mounting it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mkdir fw_fs
</span></span><span style=display:flex><span>$ sudo mount rootfs ./fw_fs
</span></span></code></pre></div><p>Let’s <code>cd</code> into the newly mounted directory and check what it contains.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ls -la
</span></span><span style=display:flex><span>  .rw-rw-r-- <span style=color:#ae81ff>0</span> root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> .lstripped
</span></span><span style=display:flex><span>  drwxrwxr-x - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> bin
</span></span><span style=display:flex><span>  lrwxrwxrwx - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> config -&gt; ./var/config/
</span></span><span style=display:flex><span>  drwxrwxr-x - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> dev
</span></span><span style=display:flex><span>  drwxrwxr-x - root  <span style=color:#ae81ff>1</span> Oct  <span style=color:#ae81ff>2023</span> etc
</span></span><span style=display:flex><span>  drwxrwxr-x - root  <span style=color:#ae81ff>1</span> Oct  <span style=color:#ae81ff>2023</span> home
</span></span><span style=display:flex><span>  drwxrwxr-x - root  <span style=color:#ae81ff>1</span> Oct  <span style=color:#ae81ff>2023</span> image
</span></span><span style=display:flex><span>  drwxrwxr-x - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> lib
</span></span><span style=display:flex><span>  lrwxrwxrwx - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> mnt -&gt; /var/mnt
</span></span><span style=display:flex><span>  drwxrwxr-x - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> overlay
</span></span><span style=display:flex><span>  drwxrwxr-x - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> proc
</span></span><span style=display:flex><span>  drwxrwxr-x - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> run
</span></span><span style=display:flex><span>  lrwxrwxrwx - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> sbin -&gt; /bin
</span></span><span style=display:flex><span>  drwxrwxr-x - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> sys
</span></span><span style=display:flex><span>  lrwxrwxrwx - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> tmp -&gt; /var/tmp
</span></span><span style=display:flex><span>  drwxrwxr-x - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> usr
</span></span><span style=display:flex><span>  drwxrwxr-x - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> var
</span></span></code></pre></div><p>As you can see, there’s a <em>config</em> file symlinked to <em>./var/config/</em>, so I initially tried exploring that. However, the symlink was broken, and the <em>/var</em> directory was empty. Then, I noticed the <em>/home</em> directory and checked if it contained anything useful. It did, in fact, have a hidden directory with a file inside. I quickly read through it, but it didn’t contain the flag. However, it did have a string: &ldquo;almost there,&rdquo; which means we’re on the right track.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ls -la home
</span></span><span style=display:flex><span>  drwxr-xr-x - root  <span style=color:#ae81ff>1</span> Oct  <span style=color:#ae81ff>2023</span> .41fr3d0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ ls -la home/.41fr3d0
</span></span><span style=display:flex><span>  .rw-r--r-- <span style=color:#ae81ff>13</span> root  <span style=color:#ae81ff>1</span> Oct  <span style=color:#ae81ff>2023</span> s.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat home/41fr3d0/s.txt
</span></span><span style=display:flex><span>  almost there
</span></span></code></pre></div><p>So where could the flag be? I then looked into the <em>etc</em> directory since that&rsquo;s where Unix/Linux-based systems generally store application-specific config files. I found an interesting file there. Remember the broken <em>config</em> file located in the root directory? The <em>etc</em> directory also had a <em>config</em> file, along with a <em>config_default.xml</em>. That looked promising, so I opened it in <code>vim</code> and searched for anything related to the flag. It contained a lot of application-specific config options, including hard-coded credentials.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ls -la etc
</span></span><span style=display:flex><span>  lrwxrwxrwx    - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> config -&gt; /var/config
</span></span><span style=display:flex><span>  .rwxrwxr-x  51k root  <span style=color:#ae81ff>1</span> Oct  <span style=color:#ae81ff>2023</span> config_default.xml
</span></span><span style=display:flex><span>  .rwxrwxr-x  <span style=color:#ae81ff>185</span> root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> config_default_hs.xml
</span></span><span style=display:flex><span>  drwxrwxr-x    - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> cups
</span></span><span style=display:flex><span>  drwxrwxr-x    - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> default
</span></span><span style=display:flex><span>  .rwxrwxr-x  18k root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> dhclient-script
</span></span><span style=display:flex><span>  .rwxrwxr-x  19k root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> dnsmasq.conf
</span></span><span style=display:flex><span>  .rwxrwxr-x 1.1k root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> ethertypes
</span></span><span style=display:flex><span>  .rw-rw-r--  <span style=color:#ae81ff>637</span> root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> fstab
</span></span><span style=display:flex><span>  lrwxrwxrwx    - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> group -&gt; /var/group
</span></span><span style=display:flex><span>  .rw-rw-r--  <span style=color:#ae81ff>127</span> root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> inetd.conf
</span></span><span style=display:flex><span>  drwxrwxr-x    - root <span style=color:#ae81ff>10</span> Aug  <span style=color:#ae81ff>2022</span> init.d
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ vim etc/config_default.xml
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  &lt;Value Name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;SUSER_NAME&#34;</span> Value<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;admin&#34;</span>/&gt;
</span></span><span style=display:flex><span>  &lt;Value Name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;SUSER_PASSWORD&#34;</span> Value<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;HTB{N0******************1n}&#34;</span>/&gt;
</span></span><span style=display:flex><span>  ...
</span></span></code></pre></div><p>So, let&rsquo;s unmount the file system since it is no longer needed and then submit the flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd ..
</span></span><span style=display:flex><span>$ sudo umount ./fw_fs
</span></span></code></pre></div></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><a href=https://favas.dev/blogs/hackthebox/challenges/reversing/simple-encryptor/ class="button inline next">Simple Encryptor Walkthrough - HackTheBox</a></div></div></article></div><script type=text/javascript src=/bundle.min.js></script></div></body></html>